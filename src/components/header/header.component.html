
<header class="sticky top-0 bg-white shadow-md z-20 px-4 py-3 flex items-center justify-between">
  <!-- Left Section -->
  <div class="flex items-center space-x-4">
    @if(currentView() !== 'home') {
      <button (click)="goBack()" class="text-gray-700">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>
    } @else {
      <button (click)="toggleSidebar()" class="text-gray-700 lg:hidden">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    }
    <div (click)="goHome()" class="cursor-pointer font-bold text-lg leading-tight">
        <div>
            <span class="text-pink-500">Crazy</span>
            <span class="text-gray-800">Basket</span>
        </div>
        <div class="text-xs font-semibold text-center text-black tracking-widest">
            MALL
        </div>
    </div>
  </div>
  
  <!-- Desktop Search -->
  <div class="hidden lg:flex flex-grow max-w-lg ml-8 relative">
     <form (submit)="onSearch()" class="w-full">
        <input [(ngModel)]="searchQuery" (ngModelChange)="onSearchInput()" (focus)="showSuggestions.set(true)" (blur)="showSuggestions.set(false)" name="search" type="text" placeholder="Search for products, brands and more" class="w-full bg-gray-100 border border-gray-200 rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-pink-400">
      </form>
      @if (showSuggestions() && suggestions().length > 0) {
        <div class="absolute top-full left-0 right-0 bg-white border rounded-md mt-1 shadow-lg overflow-hidden z-30">
          @for(product of suggestions(); track product.id) {
            <div (mousedown)="selectSuggestion(product)" class="flex items-center p-2 hover:bg-gray-100 cursor-pointer">
              <img [src]="product.images[0]" alt="" class="w-10 h-12 object-cover mr-3">
              <div>
                <p class="font-semibold text-sm">{{ product.brand }}</p>
                <p class="text-xs text-gray-500">{{ product.name }}</p>
              </div>
            </div>
          }
        </div>
      }
  </div>
  
  <!-- Right Section Icons -->
  <div class="flex items-center space-x-4 text-gray-700">
    <button (click)="isMobileSearchActive.set(true)" class="lg:hidden">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
    </button>
    <div class="hidden lg:flex items-center space-x-4">
        <div class="flex flex-col items-center cursor-pointer" (click)="goToProfile()">
             <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
             <span class="text-xs font-semibold">Profile</span>
        </div>
        <div class="flex flex-col items-center cursor-pointer" (click)="goToCart()">
            <div class="relative">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" /></svg>
                @if (cartItemCount() > 0) {
                    <span class="absolute -top-2 -right-2 bg-pink-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">{{ cartItemCount() }}</span>
                }
            </div>
            <span class="text-xs font-semibold">Bag</span>
        </div>
    </div>
  </div>
</header>

<!-- Mobile Search Overlay -->
@if(isMobileSearchActive()) {
  <div class="fixed inset-0 bg-white z-50">
    <div class="flex items-center p-2 border-b">
      <button (click)="isMobileSearchActive.set(false)" class="p-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" /></svg>
      </button>
      <form (submit)="onSearch()" class="w-full">
        <input [(ngModel)]="searchQuery" (ngModelChange)="onSearchInput()" name="searchMobile" type="text" placeholder="Search for products..." class="w-full bg-transparent py-2 px-2 focus:outline-none" autofocus>
      </form>
    </div>
    @if (suggestions().length > 0) {
      <div class="overflow-y-auto">
        @for(product of suggestions(); track product.id) {
          <div (mousedown)="selectSuggestion(product)" class="flex items-center p-3 border-b hover:bg-gray-100 cursor-pointer">
            <img [src]="product.images[0]" alt="" class="w-12 h-16 object-cover mr-4">
            <div>
              <p class="font-semibold">{{ product.brand }}</p>
              <p class="text-sm text-gray-600">{{ product.name }}</p>
            </div>
          </div>
        }
      </div>
    }
  </div>
}