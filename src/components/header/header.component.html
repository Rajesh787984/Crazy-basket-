
<div class="sticky top-0 z-20 bg-white shadow-md">
  <header class="px-4 py-2 flex items-center justify-between">
    <!-- Left Section -->
    <div class="flex items-center space-x-4">
      @if(currentView() !== 'home') {
        <button (click)="goBack()" class="text-gray-700">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
        </button>
      } @else {
        <button (click)="toggleSidebar()" class="text-gray-700 lg:hidden">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
        </button>
      }
      <div (click)="goHome()" class="cursor-pointer flex items-center">
        <svg class="h-8 w-auto" viewBox="0 0 250 40" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" stroke="#F97316" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none" transform="scale(1.4) translate(2, 3)"></path>
            <text x="55" y="32" font-family="sans-serif" font-size="28" font-weight="bold" fill="#2563EB">Crazy</text>
            <text x="150" y="32" font-family="sans-serif" font-size="28" font-weight="bold" fill="#F97316">Basket</text>
        </svg>
      </div>
    </div>
    
    <!-- Desktop Search -->
    <div class="hidden lg:flex flex-grow max-w-lg ml-8 relative">
      <div class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
      </div>
       <form (submit)="onSearch()" class="w-full">
          <input [(ngModel)]="searchQuery" (ngModelChange)="onSearchInput()" (focus)="onSearchInput()" name="search" type="text" placeholder="Search for products, brands and more" class="w-full bg-gray-100 border border-transparent rounded-md py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-pink-400 focus:bg-white">
        </form>
        @if (showSuggestions() && suggestions().length > 0) {
          <div class="absolute top-full left-0 right-0 bg-white border rounded-md mt-1 shadow-lg overflow-hidden z-30">
            @for(suggestion of suggestions(); track suggestion) {
              <div (mousedown)="selectSuggestion(suggestion)" class="flex items-center p-2 hover:bg-gray-100 cursor-pointer">
                @if ('type' in suggestion && suggestion.type === 'category') {
                  <div class="w-10 h-12 flex items-center justify-center mr-3"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A2 2 0 013 12V7a4 4 0 014-4z" /></svg></div>
                  <div><p class="font-semibold text-sm">{{ suggestion.name }}</p><p class="text-xs text-gray-500">in Category</p></div>
                } @else {
                  @let product = suggestion;
                  <img [src]="product.images[0]" [alt]="product.name" class="w-10 h-12 object-cover mr-3">
                  <div><p class="font-semibold text-sm">{{ product.name }}</p><p class="text-xs text-gray-500">{{ product.category }}</p></div>
                }
              </div>
            }
          </div>
        }
    </div>
    
    <!-- Right Section Icons -->
    <div class="flex items-center space-x-4 md:space-x-6 text-gray-700">
      <div class="hidden lg:flex items-center space-x-6">
        <div class="flex flex-col items-center cursor-pointer" (click)="goToProfile()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
            <span class="text-xs font-semibold">Profile</span>
        </div>
      </div>
      <button (click)="goToWishlist()" class="flex flex-col items-center cursor-pointer relative">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>
          <span class="text-xs font-semibold hidden lg:inline">Wishlist</span>
          @if (wishlistItemCount() > 0) {
            <span class="absolute -top-1 -right-1.5 bg-pink-500 text-white text-[10px] font-bold rounded-full h-4 w-4 flex items-center justify-center">{{ wishlistItemCount() }}</span>
          }
      </button>
      <button (click)="goToCart()" class="flex flex-col items-center cursor-pointer relative">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" /></svg>
          <span class="text-xs font-semibold hidden lg:inline">Bag</span>
          @if (cartItemCount() > 0) {
            <span class="absolute -top-1 -right-1.5 bg-pink-500 text-white text-[10px] font-bold rounded-full h-4 w-4 flex items-center justify-center">{{ cartItemCount() }}</span>
          }
      </button>
    </div>
  </header>

  <!-- Mobile Search Bar -->
  <div class="p-2 border-b lg:hidden">
    <div class="relative">
      <div class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
      </div>
      <form (submit)="onSearch()" class="w-full">
        <input [(ngModel)]="searchQuery" (ngModelChange)="onSearchInput()" (focus)="onSearchInput()" name="searchMobile" type="text" placeholder="Search for products, brands..." class="w-full bg-gray-100 border border-transparent rounded-md py-2 pl-10 pr-4 text-sm focus:outline-none focus:ring-2 focus:ring-pink-400 focus:bg-white">
      </form>
       @if (showSuggestions() && suggestions().length > 0) {
        <div class="absolute top-full left-0 right-0 bg-white border rounded-md mt-1 shadow-lg overflow-y-auto max-h-80 z-30">
           @for(suggestion of suggestions(); track suggestion) {
            <div (mousedown)="selectSuggestion(suggestion)" class="flex items-center p-2 hover:bg-gray-100 cursor-pointer">
              @if ('type' in suggestion && suggestion.type === 'category') {
                <div class="w-10 h-12 flex items-center justify-center mr-3"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A2 2 0 013 12V7a4 4 0 014-4z" /></svg></div>
                <div><p class="font-semibold text-sm">{{ suggestion.name }}</p><p class="text-xs text-gray-500">in Category</p></div>
              } @else {
                @let product = suggestion;
                <img [src]="product.images[0]" [alt]="product.name" class="w-10 h-12 object-cover mr-3">
                <div><p class="font-semibold text-sm">{{ product.name }}</p><p class="text-xs text-gray-500">{{ product.category }}</p></div>
              }
            </div>
          }
        </div>
      }
    </div>
  </div>

  <!-- Desktop Category Nav -->
  <nav class="hidden lg:flex items-center justify-center space-x-8 h-12 border-b">
    @for(category of categories(); track category.id) {
      <a (click)="selectCategory(category.name)" class="font-semibold text-gray-700 hover:text-pink-500 cursor-pointer transition-colors border-b-2 border-transparent hover:border-pink-500 h-full flex items-center">
        {{ category.name.toUpperCase() }}
      </a>
    }
  </nav>

</div>
